<!-- gestion_general/templates/gestion_general/dashboard.html -->
{% extends "gestion_general/base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h1>Dashboard</h1>

<h3>Productos (resumen)</h3>
<table class="table table-sm">
  <thead><tr><th>SKU</th><th>Nombre</th><th>Stock</th><th>Mínimo</th><th>Estado</th></tr></thead>
  <tbody>
    {% for producto in productos %}
      <tr>
        <td>{{ producto.sku }}</td>
        <td>{{ producto.nombre }}</td>
        <td>{{ producto.stock_actual }}</td>
        <td>{{ producto.stock_minimo }}</td>
        <td>
          {% if producto.stock_actual <= producto.stock_minimo %}
            <span class="badge bg-danger">Crítico</span>
          {% else %}
            <span class="badge bg-success">OK</span>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<h3 class="mt-4">Pedidos recientes</h3>
<table class="table table-sm">
  <thead><tr><th>ID</th><th>Cliente</th><th>Estado</th><th>Fecha</th></tr></thead>
  <tbody>
    {% for pedido in pedidos %}
      <tr>
        <td><a href="{% url 'pedido_detail' pedido.id %}">{{ pedido.id }}</a></td>
        <td>{{ pedido.cliente }}</td>
        <td>{{ pedido.get_estado_display }}</td>
        <td>{{ pedido.fecha|date:"d/m/Y H:i" }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="4">No hay pedidos</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}